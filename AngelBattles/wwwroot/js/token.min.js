var rpcConnected=null,account=undefined,angelDict=[],petDict=[],accessoryDict=[];window.addEventListener("load",function(){var t,n;typeof web3!="undefined"?(window.web3=new Web3(web3.currentProvider),(web3.eth.accounts[0]||null)!==account&&(account=web3.eth.accounts[0]||null,account&&(web3.eth.defaultAccount=account),console.log("INFO_LOG|update_account_info|account="+account)),t=setInterval(function(){(web3.eth.accounts[0]||null)!==account&&(account=web3.eth.accounts[0]||null,account,console.log("INFO_LOG|update_account_info|account="+account))},500),web3.version.getNetwork((n,t)=>{switch(t){case"1":console.log("INFO_LOG|running_on_main_net.");break;case"2":console.log("INFO_LOG|running_on_deprecatedmorden_test_network.");break;case"3":console.log("INFO_LOG|running_on_ropsten_test_network.");break;default:console.log("INFO_LOG|running_on_unknown_network.")}}),rpcConnected=!0):(rpcConnected=!1,account=null);angelCardDataContractInstance=getAngelCardDataContractInstance();petCardDataContractInstance=getPetCardDataContractInstance();accessoryDataContractInstance=getAccessoryDataContractInstance();n=getCardId();rpcConnected&&(getCardType()==="angel"?getAngel(n):getCardType()==="pet"?getPet(n):getCardType()==="acc"&&getAccessory(n))});var getParameterByName=function(n,t){t||(t=window.location.href);n=n.replace(/[\[\]]/g,"\\$&");var r=new RegExp("[?&]"+n+"(=([^&#]*)|&|#|$)"),i=r.exec(t);return i?i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):"":null},getCardSeriesId=function(){return getParameterByName("seriesid")},getCardId=function(){return getParameterByName("id")},getCardType=function(){return getParameterByName("type")},getAngel=function(n){angelCardDataContractInstance.getAngel(n,function(n,t){var r;if(n)console.log("ERROR_LOG|getAngel_txn_fail|error="+n);else{var u=t[0].toNumber(),f=t[1].toNumber(),e=t[2].toNumber(),o=t[3].toNumber(),s=t[4].toNumber(),i=t[5].toNumber();i>0&&(i=Number(web3.fromWei(i,"ether")));var h=t[6].toString(),l=t[7].toString(),a=t[8].toString(),v=t[9].toNumber(),c=t[10].toString();angelDict.push({angelId:u,angelCardSeriesId:f,battlePower:e,aura:o,experience:s,price:i,createdTime:h,owner:c});r={AngelData:angelDict};$.ajax({dataType:"html",type:"POST",url:"/Token/GetAngel",data:r,success:function(n){console.log(n);window.location.href="/api/TokenApi/byType?type=angel&value="+encodeURIComponent(n)},failure:function(){}})}})},getPet=function(n){petCardDataContractInstance.getPet(n,function(n,t){var i;if(n)console.log("ERROR_LOG|getPet_txn_fail|error="+n);else{var r=t[0].toNumber(),u=t[1].toNumber(),f=t[2].toString(),e=t[3].toNumber(),o=t[4].toNumber(),s=t[5].toNumber(),h=t[6].toNumber(),l=t[7].toString(),a=t[8].toString(),c=t[9].toString();petDict.push({petId:r,petCardSeriesId:u,name:f,luck:e,auraRed:o,auraBlue:s,auraYellow:h,owner:c});i={PetData:petDict};$.ajax({dataType:"html",type:"POST",url:"/Token/GetPet",data:i,success:function(n){console.log(n);window.location.href="/api/TokenApi/byType?type=pet&value="+encodeURIComponent(n)},failure:function(){}})}})},getAccessory=function(n){accessoryDataContractInstance.getAccessory(n,function(n,t){var i;if(n)console.log("ERROR_LOG|getAccessory_txn_fail|error="+n);else{var r=t[0].toNumber(),u=t[1].toNumber(),f=t[2].toString();accessoryDict.push({accessoryId:r,accessorySeriesId:u,owner:f});i={AccessoryData:accessoryDict};$.ajax({dataType:"html",type:"POST",url:"/Token/GetAccessory",data:i,success:function(n){console.log(n);window.location.href="/api/TokenApi/byType?type=acc&value="+encodeURIComponent(n)},failure:function(){}})}})};