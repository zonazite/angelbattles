function DisplayAngelCards(n){var t={AngelsList:n};$.ajax({dataType:"html",type:"POST",url:"/Training/GetAngelCardRows",data:t,success:function(n){$("#loader").hide();$("#trainingContainer").fadeIn();$("#angelsContainer").html(n);$("#angelsContainer").fadeIn();$(".angel-training-card").on("click",function(){var n=$(this),t=getCardSeriesImageSrc("angel",n.data("angelcardseriesid").toString()),i=n.find(".aura-gem").attr("src");$("#angelToTrain #angelAuraGem").attr("src",i).show();$("#chooseAngelText").hide();$("#angelToTrain #angelImage").attr("src",t).fadeIn();$("#choosePetOneText").fadeIn();$("#angelsContainer").fadeOut(200,function(){$("#petsContainer").fadeIn(200)});$("#angelToTrain").attr("data-angelid",n.data("angelid"))})},failure:function(){$("#loader").hide();$("#warnNoCardsFoundAngel").show()}})}function DisplayPetCards(n){for(var r,u,i=96,t=0;t<n.length;t+=i)r=n.slice(t,t+i),u={PetsList:r},$.ajax({dataType:"html",type:"POST",url:"/Training/GetPetCardRows",data:u,success:function(n){$("#petsContainer").append(n);$(".pet-training-card").not(".in-training").each(function(){var n=$(this).data("petid"),t=Cookies.get("pet1:"+n.toString());t==="pending"&&($(this).find("#inTrainingWarn").show(),$(this).find("#petAura").hide(),$(this).removeClass("hand-cursor").addClass("no-pointers-events"))});$(".pet-training-card.in-training").each(function(){var n=$(this).data("petid"),t=Cookies.get("pet1:"+n);t==="pending"&&Cookies.remove("pet1:"+n.toString())});$(".pet-training-card").on("click",function(n){var r,t,i;return n.stopImmediatePropagation(),n.preventDefault(),$(n.target).hasClass("get-more")?(r=$(n.target).attr("href"),$(location).attr("href",r)):(t=$(this),i=getCardSeriesImageSrc("pet",t.data("petcardseriesid").toString()),$("#choosePetOneText").is(":visible")?($("#petOneImage").fadeOut(200,function(){$("#petOneImage").attr("src",i)}).fadeIn(200),$("#choosePetOneText").hide(),$("#petOneToTrain").attr("data-petoneid",t.data("petid")),$("#petTwoImage").is(":visible")||$("#choosePetTwoText").fadeIn()):$("#choosePetTwoText").is(":visible")&&($("#petTwoImage").fadeOut(200,function(){$("#petTwoImage").attr("src",i)}).fadeIn(200),$("#choosePetTwoText").hide(),$("#petTwoToTrain").attr("data-pettwoid",t.data("petid")),$("#petsContainer").fadeOut(),$("#beginTraining").fadeIn()),t.fadeOut()),!1});loadEachPetRestEndTime()},failure:function(){$("#warnNoCardsFoundPet").show()}})}function isEtherAccountActive(){return account!==null&&account!==undefined}var loadEachPetRestEndTime;$(document).ready(function(){var n=document.getElementById("scene"),t=new Parallax(n,{relativeInput:!0});t.friction(.2,.2);$("#teamContainer .lazy").lazy({appendScroll:$("#cardsContainer")});$("#beginTrainingButton").click(function(){isEtherAccountActive()?train():showMetaMaskAlertNotLoggedIn()});$("#keepTraining").click(function(){setTimeout(function(){location.reload()},100)})});var rpcConnected=null,account=undefined,angelDict=[],petDict=[];window.addEventListener("load",function(){if(typeof web3!="undefined"){window.web3=new Web3(web3.currentProvider);(web3.eth.accounts[0]||null)!==account&&(account=web3.eth.accounts[0]||null,account?web3.eth.defaultAccount=account:setTimeout(function(){showMetaMaskAlertNotLoggedIn()},5e3),console.log("INFO_LOG|update_account_info|account="+account));var n=setInterval(function(){(web3.eth.accounts[0]||null)!==account&&(account=web3.eth.accounts[0]||null,account,location.reload(),console.log("INFO_LOG|update_account_info|account="+account))},500);web3.version.getNetwork((n,t)=>{switch(t){case"1":console.log("INFO_LOG|running_on_main_net.");break;case"2":console.log("INFO_LOG|running_on_deprecatedmorden_test_network.");showMetaMaskAlertWrongNetwork();break;case"3":console.log("INFO_LOG|running_on_ropsten_test_network.");showMetaMaskAlertWrongNetwork();break;default:console.log("INFO_LOG|running_on_unknown_network.");showMetaMaskAlertWrongNetwork()}});rpcConnected=!0}else rpcConnected=!1,showMetaMaskAlert(),account=null;angelCardDataContractInstance=getAngelCardDataContractInstance();petCardDataContractInstance=getPetCardDataContractInstance();trainingFieldContractInstance=getTrainingFieldDataContractInstance();rpcConnected&&($("#loader").fadeIn(),getAngelByIndex(null,DisplayAngelCards),getPetByIndex(null,DisplayPetCards))});loadEachPetRestEndTime=function(){$(".petRestingTime").each(function(){var t=$(this),i=t.data("endtime"),n;i!==""&&(n=new Date(parseInt(i)*1e3),n.setHours(n.getHours()+24),t.countdown(n,function(n){t.html(n.strftime("%H hours %M minutes %S seconds"))}))})};var getOwnerAngelCount=function(n,t){if(!web3.isAddress(n)){console.log("invalid_address|address="+n);return}angelCardDataContractInstance.getOwnerAngelCount(n,function(n,i){if(n)console.log("ERROR_LOG|getAngelCardSeries_txn_fail|error="+n);else{var r=i.toNumber();r>0&&(r=Number(r));console.log("INFO_LOG|getOwnerAngelCount|value="+r);t({value:r})}})},getAngelByIndex=function(n,t){function i(n){function f(){u===r&&t(angelDict)}var r=n.value,u=0,i;if(r>0)for(i=0;i<r;i++)angelCardDataContractInstance.getAngelByIndex(account,i,function(n,t){if(n)console.log("ERROR_LOG|getAngelByIndex_txn_fail|error="+n);else{var i=Number(t);console.log("INFO_LOG|getOwnerAngelCount|value="+i);angelCardDataContractInstance.getAngel(i,function(n,t){if(n)console.log("ERROR_LOG|getAngel_txn_fail|error="+n);else{u+=1;var e=t[0].toNumber(),o=t[1].toNumber(),s=t[2].toNumber(),h=t[3].toNumber(),c=t[4].toNumber(),i=t[5].toNumber();i>0&&(i=Number(web3.fromWei(i,"ether")));var l=t[6].toString(),a=t[7].toString(),v=t[8].toString(),y=t[9].toNumber(),r=t[10].toString();r===account&&angelDict.push({angelId:e,angelCardSeriesId:o,battlePower:s,aura:h,experience:c,price:i,createdTime:l,lastBattleTime:a,lastVsBattleTime:v,lastBattleResult:y,owner:r});f()}})}});else $("#loader").hide(),$("#warnNoCardsFoundAngel").fadeIn()}getOwnerAngelCount(account,i)},getOwnerPetCount=function(n,t){if(!web3.isAddress(n)){console.log("invalid_address|address="+n);return}petCardDataContractInstance.getOwnerPetCount(n,function(n,i){if(n)console.log("ERROR_LOG|getOwnerPetCount_txn_fail|error="+n);else{var r=i.toNumber();r>0&&(r=Number(r));console.log("INFO_LOG|getOwnerPetCount|value="+r);t({value:r})}})},getPetByIndex=function(n,t){function i(n){function f(){u===i&&t(petDict)}var i=n.value,u=0,r;if(i>=2)for(r=0;r<i;r++)petCardDataContractInstance.getPetByIndex(account,r,function(n,t){if(n)console.log("ERROR_LOG|getPetByIndex_txn_fail|error="+n);else{var i=Number(t);console.log("INFO_LOG|getOwnerPetCount|value="+i);petCardDataContractInstance.getPet(i,function(n,t){if(n)console.log("ERROR_LOG|getPet_txn_fail|error="+n);else{u+=1;var r=t[0].toNumber(),e=t[1].toNumber(),o=t[2].toString(),s=t[3].toNumber(),h=t[4].toNumber(),c=t[5].toNumber(),l=t[6].toNumber(),a=t[7].toString(),v=t[8].toString(),i=t[9].toString();i===account&&petDict.push({petId:r,petCardSeriesId:e,name:o,luck:s,auraRed:h,auraBlue:c,auraYellow:l,lastTrainingTime:a,lastBreedingTime:v,owner:i});f()}})}});else $("#loader").hide(),i===1?$("#warnNeedOneMorePetCard").fadeIn():$("#warnNoCardsFoundPet").fadeIn()}getOwnerPetCount(account,i)},train=function(){var i=$("#angelToTrain").data("angelid"),n=$("#petOneToTrain").data("petoneid"),t=$("#petTwoToTrain").data("pettwoid");trainingFieldContractInstance.Train(i,n,t,{gas:25e4},function(i){i?console.log("ERROR_LOG|createAngel_txn_fail|error="+i):($("#trainingOuterContainer").hide(),$("#trainingCompleted").fadeIn(),setCookie("pet1",n,4),setCookie("pet1",t,4))})};